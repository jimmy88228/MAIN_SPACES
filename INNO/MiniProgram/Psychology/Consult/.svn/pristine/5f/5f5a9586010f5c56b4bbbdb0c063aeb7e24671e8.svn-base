<template>
  <view class="report-info bg_f9fcfe">
    <view class="report-background"></view>
    <page-nav :bgStyle="'background:transparent'"></page-nav>
    <view class="report-area relative p-l-25 p-r-25 p-b-32" v-if="hasData">
      <view class="">
        <view class="flex-b-s m-r-13 m-l-13 p-b-38">
          <view class="">
            <view class="report-title C_fff font-24 m-b-20">测评报告</view>
            <view class="font-38 C_fff m-b-15 clamp2" style="width: 460rpx">{{
              analyze.activityName
            }}</view>
            <view class="font-22 C_fff opa-50"
              >测评时间 {{ analyze.completeTime }}</view
            >
          </view>
        </view>
        <view class="relative">
          <view class="score m-b-32">
            <view class="font-24 C_7f">报告总分</view>
            <view class="flex-c-c flex1 C_0083ce">
              <view class="font-66">{{ analyze.coefficientPoints }}</view
              ><view class="m-l-12 p-t-20 font-24">分</view>
            </view>
          </view>
          <image
            :src="reportInfoIcon"
            class="report-info-icon"
            mode="scaleToFill"
          />
        </view>
      </view>
      <view class="report-score-table m-b-25">
        <view class="flex bg_eff7fd C_0083ce font-20 p-l-20 p-r-20">
          <view class="report-score-table-row1 p-t-20 p-b-20 p-l-20 p-r-20"
            >因子</view
          >
          <view class="report-score-table-row2 p-t-20 p-b-20 p-l-20 p-r-20"
            >原始分</view
          >
          <view class="report-score-table-row3 p-t-20 p-b-20 p-l-20 p-r-20"
            >参考判断</view
          >
        </view>
        <view
          class="flex C_333 font-22 p-l-20 p-r-20"
          v-for="(item, i) in analyze.ruleList"
          :key="i"
        >
          <view class="report-score-table-row1 p-t-20 p-b-20 p-l-20 p-r-20">{{
            item.ruleName
          }}</view>
          <view class="report-score-table-row2 p-t-20 p-b-20 p-l-20 p-r-20">{{
            item.coefficientPoints
          }}</view>
          <view class="report-score-table-row3 p-t-20 p-b-20 p-l-20 p-r-20">{{
            item.rangeName
          }}</view>
        </view>
      </view>
      <view class="wrap m-b-25">测评分析</view>
      <view
        class="analyze-item m-t-20 p-l-32 p-r-32"
        v-for="(item, i) in analyze.ruleList"
        :key="i"
      >
        <view class="C_06509b p-t-32">
          {{ item.ruleName }} ({{ item.coefficientPoints }}{{ item.pointType }})
        </view>
        <view class="C_333 font-24 p-t-32 bold" >
          <text user-select>{{ item.rangeShortDesc }}</text>
        </view>
        <view class="C_50 font-22 p-t-32 p-b-32">
          <text user-select>{{ item.rangeDescription }}</text>
        </view>
      </view>
    </view>
  </view>
</template>
 
<script>
import LoadingView from "@/components/css3/loading/loading.vue";
import utils from "@/common/support/utils.js";
const app = getApp();
const pageOption = Page.BasePage({
  components: {
    LoadingView,
  },
  data() {
    return {
      options: {},
      reportInfoIcon: require("@/static/report-info.png"),
      hasData: false,
      analyze: {},
    };
  },
  onLoad(options) {
    this.options = options;
  },
  onShow() {},
  onReady() {
    this.loadData();
  },
  methods: {
    loadData() {
      let recordId = this.options.recordId;
      return this.$Http(this.$Apis.getReportDetail, {
        data: {
          recordId,
        },
        other: {
          showLoading: true,
        },
      }).then((res) => {
        this.analyze = res.data || {};
        this.hasData = true;
        return res;
      });
    },
  },
});
export default pageOption;
</script>

<style lang="scss" scoped>
.report-info {
  min-height: 100vh;
  .report-background {
    position: absolute;
    width: 100%;
    height: 520rpx;
    background: linear-gradient(
      180deg,
      $uni-main-color 0%,
      #2084ca 42%,
      #f9fcfe 100%
    );
  }
  .report-area {
    margin-top: 50rpx;
    .report-title {
      width: 123rpx;
      padding: 8rpx 0;
      background: rgba($color: #00456d, $alpha: 0.65);
      border-radius: 4rpx;
      text-align: center;
    }
    .score {
      position: relative;
      display: flex;
      flex-flow: column;
      width: 700rpx;
      height: 200rpx;
      padding: 19rpx 31rpx;
      box-sizing: border-box;
      background: #ffffff;
      box-shadow: 0rpx 7rpx 17rpx 0rpx rgba(6, 80, 155, 0.07);
      border-radius: 20rpx;
      z-index: 2;
    }
    .report-info-icon {
      position: absolute;
      right: 0rpx;
      top: -205rpx;
      width: 184rpx;
      height: 191rpx;
      margin-top: 21rpx;
      flex-shrink: 0;
      z-index: 1;
    }
    .report-score-table {
      border-radius: 20rpx;
      background: #ffffff;
      overflow: hidden;
      & > view:nth-child(n + 2) {
        font-weight: bold;
      }
      .report-score-table-row1,
      .report-score-table-row2 {
        width: 25%;
      }
      .report-score-table-row3 {
        width: 50%;
      }
    }
    .analyze-item {
      border-radius: 20rpx;
      background: #ffffff;
      & > view:nth-child(3) {
        line-height: 42rpx;
      }
    }
  }
}

.wrap {
  display: table;
  width: 100%;
  white-space: nowrap;
  border-spacing: 2rpx 0;
  font-size: 24rpx;
  color: #8e8e8e;
  text-align: center;
  box-sizing: border-box;
  padding: 0 32rpx;
}
.wrap::before,
.wrap::after {
  display: table-cell;
  content: "";
  width: 35%;
  background: -webkit-linear-gradient(#dddddd, #dddddd) repeat-x left center;
  background: linear-gradient(#dddddd, #dddddd) repeat-x left center;
  background-size: 1rpx 1rpx;
}
</style>
