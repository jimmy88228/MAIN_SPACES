<template>
    <hold-layout :isFull="true" class="resource-page-layout">
      <div class="resource-name-area">{{pageQuery.customer_name}}</div>
      <Tabs :value="currentTab" @on-click="changeTab">
        <TabPane label="基础信息" name="base" :index="0">
          <baseIndex ref="baseRef" @next="nextTab"></baseIndex>
        </TabPane>
        <!-- <TabPane label="类型维护" name="type" :index="1" :disabled="!pageQuery.testId" v-if="pageQuery.type == 'dimension'">
          <typeIndex ref="typeRef"></typeIndex>
        </TabPane> -->
        <TabPane label="题目管理" name="problems" :index="2" :disabled="!pageQuery.testId">
          <problemsIndex ref="problemsRef"></problemsIndex>
        </TabPane>
        <TabPane label="结果维护" name="result" :index="3" :disabled="!pageQuery.testId">
          <resultIndex ref="resultRef"></resultIndex>
        </TabPane>
      </Tabs>
    </hold-layout>
</template>

<script>
import baseIndex from "./base/index.vue";
import typeIndex from "./type/index.vue";
import resultIndex from "./result/index.vue";
import problemsIndex from "../problems-detail/index.vue"
export default {
  name: "resourceManageIndex",
  components: { baseIndex, typeIndex, resultIndex,problemsIndex },
  data() {
    return {
      currentTab: 'base',
    };
  },
  computed:{
    // hasTest(){
    //   let query = (this.$route && this.$route.query) || {};
    //   return query.testId;
    // }
  },
  methods: {
    changeTab(name){
      if(this.currentTab != name) {
        this.currentTab = name;
      }
      let currentRef = this.$refs[name + 'Ref'];
      if(currentRef){
        currentRef.init();
      }
      let pageQuery = this.pageQuery || {};
      if(pageQuery.currentTab != name){
        this.$router.push({ query: {
          ...pageQuery,
          currentTab: name
        }})
      }
    },
    nextTab(detail){
      if(detail.name){
        this.changeTab(detail.name)
      }
    }
  },
  mounted() {
    let currentTab = this.pageQuery.currentTab || this.currentTab
    this.changeTab(currentTab);
  },
};
</script>

<style lang="less" scoped>
.resource-page-layout {
  .resource-name-area{
    padding: 0px 10px;
    margin-bottom: 10px;
  }
}
</style>
<style lang="less">
.resource-page-layout{
  .ivu-tabs{
    width:100%;
    flex: 1;
    height: 100%;
    // overflow: hidden;
    display: flex;
    flex-direction: column;
    position: relative;
    padding-top: 36px;
  }
  .ivu-tabs-bar{
    position: absolute;
    top:0px;
    left: 0px;
    width:100%;
  }
  .ivu-tabs-content{
    flex: 1;
    height: 100%;
  }
  .ivu-tabs-tabpane{
    width:100%;
    height:100%;
  }
}
</style>