<template>
  <hold-layout :isFull="true" class="edit-gauge" isShowFormSave @_cancel="cancel" @_save="save">
    <rewrite-tabs isHideLayout :data="tabList" @changeTab="changeTab" :currTab="curTab">
      <template v-slot:basic>
        <form-view ref="basic" class="box"></form-view>
      </template>
      <template v-slot:report>
        <report ref="report" class="box"></report>
      </template>
      <template v-slot:problems>
        <!-- 题目管理 -->
        <problemsDetail ref="problems"></problemsDetail>
      </template>
      <template v-slot:dimension> 
        <!-- 维度 -->
        <dimension ref="dimension" class="box"></dimension>
      </template>
    </rewrite-tabs>
  </hold-layout>
</template>

<script>
import report from "./report.vue"
import formView from "./form.vue"
import dimension from './dimension.vue'
import problemsDetail from "./problems-detail/index.vue";
export default {
  mixins: [],
  components: {
    report,
    formView,
    dimension,
    problemsDetail
  },
  data() {
    return { 
      pageId:0,
      curTab: "basic",
      tabList:[{
        name:"basic",
        label:"基础信息",
        tabName:"editGauge",
      },{
        name:"report",
        label:"报告建议",
        tabName:"editGauge",
      },{
        name:"problems",
        label:"题目维护",
        tabName:"editGauge",
      },{
        name:"dimension",
        label:"量表维度",
        tabName:"editGauge",
      }]
    };
  },
  methods: { 
      changeTab(name) {
          this.curTab = name;
          this.$refs[this.curTab] && this.$refs[this.curTab].init && this.$refs[this.curTab].init();
      },
      cancel(){
          this.$router.back();
      },
      save(){
        this.$refs["problems"] && this.$refs["problems"].confirm();
          // this.$refs.basic.save().then(()=>{
          //   this.$refs.dimension.save('save').then(()=>{
          //     this.$refs.report.clickSave();
          //   }).catch(e=>{
          //     this.curTab = 'dimension';
          //   })
          // }).catch(e=>{
          //   this.curTab = 'basic';
          // }); 
    },
  },
  mounted () { 
  },
};
</script>

<style lang="less" scoped>
.edit-gauge{
    .box{
        // padding-top: 40px;
        height: 100%;
    }
}
</style>
<style lang="less">
.edit-gauge{
    .ivu-tabs{
        height: 100%;
    }
    .ivu-tabs-content{
        height: calc(100% - 52px);
    }
}
</style>