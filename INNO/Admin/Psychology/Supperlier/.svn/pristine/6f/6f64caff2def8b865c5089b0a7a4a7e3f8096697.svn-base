<template>
  <div>
    <p>
      <Select v-model="linkInfo.code" size="small" style="width:100%;" clearable @on-change="changeLink">
        <Option v-for="item in linkSelect" :value="item.code" :key="item.code">{{item.name}}</Option>
      </Select>
      <!-- <p>
        <template v-if="linkInfo.code == 'CUSTOM-URL'">
          h5路径需以http/https开头，否则默认跳转小程序路径
        </template>
      </p> -->
    </p>
    <div>
      <template v-if="linkInfo.code == 'CUSTOM-URL'">
        <Input size="small" v-model="linkInfo.remark" placeholder="备注"></Input>
        <Input size="small" v-model="linkInfo.url" placeholder="跳转路径"></Input>
      </template>
    </div>
  </div>
</template>

<script>
export default {
  props: {
    usabledLink: {
      type: Array,
      default(){
        return []
      }
    },
    disabledLink: {
      type: Array,
      default(){
        return []
      }
    },
    linkInfo: {
      type: Object,
      default(){
        return {
          code: "",
          remark: "",
          id: "",
          url: "",
        }
      }
    }
  },
  computed: {
    linkSelect(){
      let linkList = this.linkList || [];
      let _linkList = [];
      if(this.usabledLink.length > 0){// 可用的交集
        _linkList = linkList.filter((item)=>{ return this.usabledLink.indexOf(item.code) != -1})
      } else {
        _linkList = linkList || []
      }
      if(this.disabledLink.length > 0){
        _linkList = _linkList.filter((item)=>{ return this.disabledLink.indexOf(item.code) == -1})
      }
      return _linkList || []
    }
  },
  data(){
    return {
      linkList: [
        {
          code: "CUSTOM-URL",
          name: "自定义地址"
        }
      ]
    }
  },
  methods:{
    changeLink(data){
      this.$set(this.linkInfo, "remark", "");
      this.$set(this.linkInfo, "id", "");
      this.$set(this.linkInfo, "url", "");
      console.log("linkInfo", this.linkInfo)
    }
  }
}
</script>

<style>

</style>